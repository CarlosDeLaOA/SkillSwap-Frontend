<div class="session-detail-page">
  <!-- Loading -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage && !isLoading" class="error-container">
    <div class="alert alert-danger">
      <i class='bx bx-error-circle me-2'></i>
      {{ errorMessage }}
    </div>
    <button class="btn btn-primary" (click)="goBack()">
      <i class='bx bx-arrow-back me-2'></i>
      Volver a sesiones
    </button>
  </div>

  <!-- Session Detail -->
  <div *ngIf="session && !isLoading" class="session-detail-container">
    <!-- Header -->
    <div class="page-header">
      <h1 class="page-title">
        <span class="title-register">Regístrate</span> a una 
        <span class="title-session">sesión</span>
      </h1>
      <p class="page-subtitle">
        Conecta con un SkillSwapper experto en 
        <span class="skill-name">{{ session.skill?.name || 'habilidad' }}</span>.
      </p>
    </div>

    <!-- Success Message -->
    <div *ngIf="registrationSuccess" class="alert alert-success alert-dismissible fade show" role="alert">
      <i class='bx bx-check-circle me-2'></i>
      <strong>¡Registro exitoso!</strong> Te has registrado correctamente en la sesión.
    </div>

    <!-- Error Message -->
    <div *ngIf="registrationError" class="alert alert-danger alert-dismissible fade show" role="alert">
      <i class='bx bx-error-circle me-2'></i>
      <strong>Error:</strong> {{ registrationError }}
    </div>

    <!-- Main Card -->
    <div class="detail-card">
      <!-- Left Side - Session Info -->
      <div class="session-info">
        <h2 class="session-name">{{ session.title }}</h2>
        
        <p class="session-description">{{ session.description }}</p>

        <div class="session-details">
          <div class="detail-item">
            <strong>Fecha y hora:</strong>
            <span>{{ formatDate(session.scheduledDatetime) }} - {{ formatTime(session.scheduledDatetime) }}</span>
          </div>

          <div class="detail-item">
            <strong>Duración de la sesión:</strong>
            <span>{{ session.durationMinutes }} minutos</span>
          </div>

          <div class="detail-item">
            <strong>Categoría de la sesión:</strong>
            <span>{{ session.skill?.knowledgeArea?.name || 'Categoría' }}</span>
          </div>
        </div>
      </div>

      <!-- Right Side - Registration -->
      <div class="registration-section">
        <div class="registration-type">
          <h3>Tipo de registro:</h3>
          
          <div class="radio-group">
            <label class="radio-option">
              <input 
                type="radio" 
                name="registrationType" 
                value="individual"
                checked>
              <span>Individual</span>
            </label>

            <label class="radio-option">
              <input 
                type="radio" 
                name="registrationType" 
                value="group"
                disabled>
              <span>Grupal (próximamente)</span>
            </label>
          </div>
        </div>

        <!-- Illustration -->
        <div class="illustration">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 300" width="250" height="200">
            <!-- Documento principal -->
            <rect x="120" y="60" width="160" height="200" rx="8" fill="#504ab7" opacity="0.3"/>
            <rect x="120" y="60" width="160" height="200" rx="8" fill="none" stroke="#504ab7" stroke-width="2"/>
            
            <!-- Líneas del documento -->
            <line x1="140" y1="90" x2="260" y2="90" stroke="#aae16b" stroke-width="3" stroke-linecap="round"/>
            <line x1="140" y1="110" x2="240" y2="110" stroke="#aae16b" stroke-width="3" stroke-linecap="round" opacity="0.7"/>
            <line x1="140" y1="130" x2="250" y2="130" stroke="#aae16b" stroke-width="3" stroke-linecap="round" opacity="0.7"/>
            <line x1="140" y1="150" x2="230" y2="150" stroke="#aae16b" stroke-width="3" stroke-linecap="round" opacity="0.5"/>
            
            <!-- Checkmark circular -->
            <circle cx="200" cy="190" r="25" fill="#aae16b"/>
            <path d="M 190 190 L 197 197 L 210 180" stroke="white" stroke-width="3" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
            
            <!-- Personas (iconos simplificados) -->
            <circle cx="80" cy="180" r="15" fill="#504ab7" opacity="0.6"/>
            <ellipse cx="80" cy="210" rx="20" ry="12" fill="#504ab7" opacity="0.6"/>
            
            <circle cx="320" cy="140" r="12" fill="#aae16b" opacity="0.5"/>
            <ellipse cx="320" cy="162" rx="16" ry="10" fill="#aae16b" opacity="0.5"/>
            
            <!-- Decoración adicional -->
            <circle cx="340" cy="90" r="8" fill="#504ab7" opacity="0.3"/>
            <circle cx="60" cy="100" r="6" fill="#aae16b" opacity="0.4"/>
          </svg>
        </div>

        <!-- Register Button -->
        <button 
          class="btn-register" 
          (click)="registerToSession()"
          [disabled]="isRegistering || registrationSuccess">
          <span *ngIf="!isRegistering && !registrationSuccess">Registrarme</span>
          <span *ngIf="isRegistering">
            <i class='bx bx-loader-alt bx-spin'></i> Registrando...
          </span>
          <span *ngIf="registrationSuccess">
            <i class='bx bx-check'></i> Registrado
          </span>
        </button>
      </div>
    </div>
  </div>
</div>