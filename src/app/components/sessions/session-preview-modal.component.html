<div class="modal-overlay">
  <div class="modal-container" (click)="$event.stopPropagation()">
    
  
    <div class="modal-header">
      <button class="close-btn" (click)="closeModal()">
        <i class='bx bx-x'></i>
      </button>
      <h1>Revisa tu sesión</h1>
      <p class="subtitle">Resumen de la sesión</p>
    </div>

    <div *ngIf="showNotification" class="notification"
         [class.success]="notificationType === 'success'" 
         [class.error]="notificationType === 'error'"
         [class.warning]="notificationType === 'warning'">
      <div class="notification-content">
        <i class='bx' [ngClass]="{
          'bx-check-circle': notificationType === 'success',
          'bx-error-circle': notificationType === 'error',
          'bx-error': notificationType === 'warning'
        }"></i>
        <span>{{ notificationMessage }}</span>
      </div>
      <button class="notification-close-btn" (click)="closeNotification()">
        <i class='bx bx-x'></i>
      </button>
    </div>

    <div class="preview-modal-content">
      
      <div class="content-left">
        <div class="field-group">
          <label>Título:</label>
          <div *ngIf="!isEditing" class="field-value">{{ editedTitle }}</div>
          <div *ngIf="isEditing" class="field-edit">
            <input 
              type="text" 
              [(ngModel)]="editedTitle"
              [class.invalid]="titleError"
              maxlength="200">
            <small *ngIf="titleError" class="error-text">{{ titleError }}</small>
          </div>
        </div>

        <div class="field-group">
          <label>Descripción:</label>
          <div *ngIf="!isEditing" class="field-value description">
            {{ editedDescription }}
          </div>
          <div *ngIf="isEditing" class="field-edit">
            <textarea 
              [(ngModel)]="editedDescription"
              [class.invalid]="descriptionError"
              rows="4"></textarea>
            <small *ngIf="descriptionError" class="error-text">
              {{ descriptionError }}
            </small>
          </div>
        </div>

        <div *ngIf="isEditing" class="edit-actions">
          <button class="btn-cancel-edit" (click)="cancelEdit()">
            Cancelar
          </button>
          <button class="btn-save-edit" (click)="saveEdits()">
            Guardar cambios
          </button>
        </div>
      </div>

     
      <div class="content-right">
        <div class="field-group">
          <label>Fecha y hora:</label>
          <div class="field-value">
            {{ formatDatetime(session.scheduledDatetime) }}
          </div>
        </div>

        <div class="field-group">
          <label>Duración:</label>
          <div class="field-value">{{ session.durationMinutes }} minutos</div>
        </div>

        <div class="field-group">
          <label>Habilidad:</label>
          <div class="field-value">{{ getSkillName() }}</div>
        </div>

        <div class="field-group">
          <label>Categoría:</label>
          <div class="field-value">{{ getKnowledgeAreaName() }}</div>
        </div>

        <div class="field-group">
          <label>Idioma:</label>
          <div class="field-value">{{ getLanguageName(session.language) }}</div>
        </div>

        <div class="field-group">
          <label>Capacidad:</label>
          <div class="field-value">
            {{ session.maxCapacity }} participantes
          </div>
        </div>
      </div>
    </div>

   
    <div class="modal-actions">
      <button 
        *ngIf="!isEditing"
        class="btn-edit" 
        (click)="enableEditMode()"
        [disabled]="isPublishing">
        Editar
      </button>
      
      <button 
        *ngIf="!isEditing"
        class="btn-publish" 
        (click)="publishSession()"
        [disabled]="isPublishing">
        <span *ngIf="!isPublishing">Publicar</span>
        <span *ngIf="isPublishing">Publicando...</span>
      </button>
    </div>

  
    <div class="helper-info">
      <i class='bx bx-info-circle'></i>
      <span>
        Solo puedes editar el título y la descripción. 
        Los cambios no deben exceder el 50% de la longitud original.
      </span>
    </div>
  </div>
</div>
