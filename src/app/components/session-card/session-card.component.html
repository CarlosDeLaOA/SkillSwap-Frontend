<div class="session-card" [class.suggested]="isSuggested">

  <!-- Tag movido a la esquina superior derecha y porcentaje reemplazado con icono de estrella giratorio ***
       aria-label mantenido para lectores de pantalla -->
  <div *ngIf="isSuggested" class="suggested-tag" role="status" aria-label="Recomendado para ti">
    <span class="tag-text">Para ti</span>
    <span class="match-percentage" aria-hidden="true">
      <!-- Usando clase de estrella de boxicons; si no tienes boxicons, reemplaza con un SVG inline ★ -->
      <i class="bx bx-star star-icon" aria-hidden="true"></i>
    </span>
  </div>

  <div class="session-content">
    <div class="session-header">
      <h3 class="session-title clickable" (click)="onViewDetails()">
        {{ session.title }}
      </h3>
      <span class="session-category badge" *ngIf="session.skill?.knowledgeArea?.name">
        <i class='bx bx-category-alt me-1'></i>
        {{ session.skill.knowledgeArea.name }}
      </span>
      <!-- Badge para indicar si es Premium o Gratuita -->
      <span class="session-type-badge" [class.premium]="session.isPremium" [class.free]="! session.isPremium">
        <i class='bx' [class.bx-crown]="session.isPremium" [class.bx-gift]="! session.isPremium"></i>
        <span *ngIf="session.isPremium">{{ session.skillcoinsCost }} SkillCoins</span>
        <span *ngIf="!session.isPremium">Gratuita</span>
      </span>
    </div>
    <p class="session-description">{{ session.description }}</p>
    
    <div *ngIf="isSuggested && reason" class="suggestion-reason">
      {{ reason }}
    </div>

    <div class="session-meta">
      <span class="meta-item" *ngIf="session.instructor?.person?.fullName">
        <i class='bx bx-user-circle'></i>
        {{ session.instructor.person.fullName }}
      </span>
      <span class="meta-item" *ngIf="session.skill?.name">
        <i class='bx bx-purchase-tag'></i>
        {{ session.skill.name }}
      </span>
      <span class="meta-item" *ngIf="session.language">
        <i class='bx bx-world'></i>
        {{ getLanguageName(session.language) }}
      </span>
      <span class="meta-item" *ngIf="getAvailableSpots() > 0">
        <i class='bx bx-group'></i>
        {{ getAvailableSpots() }} cupos disponibles
      </span>
    </div>
  </div>
  
  <div class="session-info">
    <div class="session-datetime">
      <div class="info-item" *ngIf="session.scheduledDatetime">
        <i class='bx bx-calendar'></i>
        <div class="info-content">
          <span class="info-label">Fecha:</span>
          <span class="info-value">{{ formatDate(session.scheduledDatetime) }}</span>
        </div>
      </div>
      <div class="info-item" *ngIf="session.scheduledDatetime">
        <i class='bx bx-time-five'></i>
        <div class="info-content">
          <span class="info-label">Hora:</span>
          <span class="info-value">{{ formatTime(session.scheduledDatetime) }}</span>
        </div>
      </div>
      <div class="info-item" *ngIf="session.durationMinutes">
        <i class='bx bx-stopwatch'></i>
        <div class="info-content">
          <span class="info-label">Duración:</span>
          <span class="info-value">{{ session.durationMinutes }} min</span>
        </div>
      </div>
    </div>
    
    <button
      class="btn btn-register"
      (click)="onRegister()"
      [disabled]="getAvailableSpots() === 0">
      <i class='bx bx-check-circle me-1' *ngIf="getAvailableSpots() > 0"></i>
      <i class='bx bx-x-circle me-1' *ngIf="getAvailableSpots() === 0"></i>
      {{ getAvailableSpots() === 0 ? 'Lleno' : 'Registrarme' }}
    </button>
  </div>
</div>